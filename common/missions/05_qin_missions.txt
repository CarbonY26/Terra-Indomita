qin_01_shan_yang = {
    header = "mission_image_china"
    icon = "general_1"

    repeatable = no
    chance = 100000

    potential = {
        NOT = { has_variable = mission_cooldown_var }
        tag = QIN
        #always = no
    }

    abort = {}
    on_start = {
        start_mission_ai_effect = yes
    }
    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = mission_cooldown_var
            days = 7300
        }
    }
    on_completion = {}
    qin_01_shan_yang_task_1 = { #Abrogate Fengjian
        icon = "task_political"
        allow = {
            political_influence >= 15
        }
        on_completion = {
            trigger_event = me_qin_shan_yang.1
            custom_tooltip = qin_01_shan_yang_task_1_tt
            add_political_influence = -15
        }
    }
    qin_01_shan_yang_task_2 = { #Claim Yiqu
        icon = "task_political"
        duration = 180
        allow = {
           treasury > 25
        }
        on_start = { add_treasury = -25 }
        on_completion = {
            #claim anding_area and tianshui_area areas and yiqu lose 50 opinion
            trigger_event = me_qin_shan_yang.2
            show_as_tooltip = {
                c:YQI = {
                    add_opinion = {
                        modifier = yiqu_is_mad_lol_pussies
                        target = root
                    }
                }
            }
            custom_tooltip = qin_01_shan_yang_task_2_tt
        }
    }
    qin_01_shan_yang_task_3 = { #Neuter Yiqu
        icon = "task_political"
        requires = { qin_01_shan_yang_task_2 }
        allow = {
            #Control anding_area and tianshui_area
            owns_or_subject_owns_area = anding_area
            owns_or_subject_owns_area = tianshui_area
        }
        on_completion = {
            random_owned_province = {
                limit = {
                    is_in_area = anding_area
                }
                state = {
                    add_state_modifier = {
                        name = destruction_of_yiqu
                        duration = 7300
                    }
                }
            }
            random_owned_province = {
                limit = {
                    is_in_area = tianshui_area
                }
                state = {
                    add_state_modifier = {
                        name = destruction_of_yiqu
                        duration = 7300
                    }
                }
            }
            trigger_event = me_qin_shan_yang.3
        }
    }
    qin_01_shan_yang_task_4 = { #Womens Militias
        icon = "task_political"
        requires = { qin_01_shan_yang_task_1 }
        duration = 550 #1.5 years
        allow = {}
        on_start = {
            #Trigger 3 random event with different descriptions so it feels different
            #trigger_event = me_qin_shan_yang.4a
        }
        on_completion = {
            custom_tooltip = TODO_events
            trigger_event = me_qin_shan_yang.4
        }
    }
    qin_01_shan_yang_task_5 = { #Sechuan Assimilation
        icon = "task_political"
        requires = { qin_01_shan_yang_task_1 }
        duration = 550
        allow = {
            political_influence >= 25
        }
        on_start = {
            #Negative events throughout...
            custom_tooltip = qin_01_shan_yang_task_5_tt
            add_political_influence = -25
        }
        on_completion = {
            trigger_event = me_qin_shan_yang.5
            #assimilation mod in guanghan_area, ba_area, shu_area and qianwei_area
        }
    }
    qin_01_shan_yang_task_6 = { #Curtail Aristocracy
        icon = "task_political"
        requires = { qin_01_shan_yang_task_1 }
        allow = {
            #Remove 7 holdings from great families (svalue in the revoke char interaction)
        }
        on_completion = {
            trigger_event = me_qin_shan_yang.6
            add_political_influence = 30
            add_legitimacy = 10
            #Give a modifier as well
            add_country_modifier = {
                name = sechuan_admin_mod
                duration = 3650
            }
        }
    }
    qin_01_shan_yang_task_7 = { #Civilize Sechuan
        icon = "task_political"
        requires = { qin_01_shan_yang_task_5 }
        allow = {
            #3 cities over 25 pops and 5 buildings in guanghan_area, ba_area, shu_area and qianwei_area areas.
        }
        on_completion = {
            trigger_event = me_qin_shan_yang.7
            add_2_free_province_investments = yes
            #Convert + promote 8-12 pops in the cities
        }
    }
    qin_01_shan_yang_task_8 = { # Meritocratic Promotion
        icon = "task_political"
        requires = { qin_01_shan_yang_task_4 }
        allow = {
            #Copy the athens tree statemenship things
        }
        on_completion = {
            trigger_event = me_qin_shan_yang.8
            #+1 all attributes for all officals and researchers
        }
    }
    qin_01_shan_yang_task_9 = { #Absolute Authority
        icon = "task_political"
        requires = { qin_01_shan_yang_task_6 }
        allow = {
            #All characters with more than 0 powerbase are loyal
        }
        on_completion = {
            trigger_event = me_qin_shan_yang.9
            add_political_influence = 20
            current_ruler.family = { add_prestige = 200 }
            add_country_modifier = {
                name = absolute_authority_country_mod
                duration = 3650
            }
        }
    }
    qin_01_shan_yang_task_10 = { #End of the Rong
        icon = "task_political"
        requires = { qin_01_shan_yang_task_3 }
        allow = {
            #Yiqu is has no land or is vassalized
        }
        on_completion = {
            trigger_event = me_qin_shan_yang.10
            add_country_modifier = {
                name = end_of_rong_country_mod
                duration = 3650
            }
        }
    }
    qin_01_shan_yang_task_11 = { #Shan Yang's Legacy
        icon = "task_political"
        requires = {
            qin_01_shan_yang_task_7
            qin_01_shan_yang_task_8
            qin_01_shan_yang_task_9
            qin_01_shan_yang_task_10
        }
        final = yes
        allow = {}
        on_completion = {
            trigger_event = me_qin_shan_yang.11
            add_political_influence = 20
            add_legitimacy = 10
            add_country_modifier = {
                name = shan_yangs_legacy_country_mod
                duration = 3650
            }
        }
    }
}